//>>built
define("gridx/modules/Header","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-construct dojo/dom-class dojo/dom-geometry dojo/query dojo/_base/sniff dojo/keys ../core/_Module".split(" "),function(n,m,p,k,f,r,h,g,l,q){return n(q,{name:"header",constructor:function(){var b=this.domNode=k.create("div",{"class":"gridxHeaderRow",role:"presentation"});this.innerNode=k.create("div",{"class":"gridxHeaderRowInner",role:"row"});this.grid._connectEvents(b,"_onMouseEvent",this)},preload:function(b){var a=
this,c=a.grid;a.domNode.appendChild(a.innerNode);a._build();c.headerNode.appendChild(a.domNode);c.vLayout.register(a,"domNode","headerNode");a.aspect(c,"onHScroll","_onHScroll");g("ff")&&a.aspect(c,"onModulesLoaded",function(){a._onHScroll(a._scrollLeft)});c.columnResizer&&a.aspect(c.columnResizer,"onResize",function(){"none"==c.hScrollerNode.style.display&&a._onHScroll(0)});a.aspect(c,"onHeaderCellMouseOver",function(){c.vLayout.reLayout()});a.aspect(c,"onHeaderCellMouseOut",function(){c.vLayout.reLayout();
setTimeout(function(){c.vLayout.reLayout()},0)});a._initFocus()},destroy:function(){this.inherited(arguments);k.destroy(this.domNode)},columnMixin:{headerNode:function(){return this.grid.header.getHeaderNode(this.id)}},hidden:!1,getHeaderNode:function(b){return h("[colid\x3d'"+this.grid._escapeId(b)+"']",this.domNode)[0]},refresh:function(){this._build();this._onHScroll(this._scrollLeft);this.grid.vLayout.reLayout();this.onRender()},onRender:function(){},onMoveToHeaderCell:function(){},_scrollLeft:0,
_build:function(){var b=this,a=b.grid,c=a.focus,e=['\x3ctable role\x3d"presentation" border\x3d"0" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\x3ctr\x3e'];p.forEach(a._columns,function(d){d._domId=(a.id+"-"+d.id).replace(/\s+/,"");e.push('\x3ctd id\x3d"',d._domId,'" role\x3d"columnheader" aria-readonly\x3d"true" tabindex\x3d"-1" colid\x3d"',d.id,'" class\x3d"gridxCell ',c&&"header"==c.currentArea()&&d.id==b._focusHeaderId?b._focusClass:"",(m.isFunction(d.headerClass)?d.headerClass(d):d.headerClass)||
"",'" style\x3d"width:',d.width,";min-width:",d.width,";",a.getTextDirStyle(d.id,d.name),(m.isFunction(d.headerStyle)?d.headerStyle(d):d.headerStyle)||"",'"\x3e\x3cdiv class\x3d"gridxSortNode"\x3e',d.name||"","\x3c/div\x3e\x3c/td\x3e")});e.push("\x3c/tr\x3e\x3c/table\x3e");b.innerNode.innerHTML=e.join("");f.toggle(b.domNode,"gridxHeaderRowHidden",b.arg("hidden"))},_onHScroll:function(b){if((g("webkit")||8>g("ie"))&&!this.grid.isLeftToRight())b=this.innerNode.scrollWidth-this.innerNode.offsetWidth-
b;this.innerNode.scrollLeft=this._scrollLeft=b},_onMouseEvent:function(b,a){var c=this.grid,e="onHeaderCell"+b,d="onHeader"+b;if(c._isConnected(e)||c._isConnected(d)){this._decorateEvent(a);if(0<=a.columnIndex)c[e](a);c[d](a)}},_decorateEvent:function(b){var a=h(b.target).closest(".gridxCell",this.domNode)[0],c=a&&this.grid._columnsById[a.getAttribute("colid")];c&&(b.headerCellNode=a,b.columnId=c.id,b.columnIndex=c.index)},_focusHeaderId:null,_focusClass:"gridxHeaderCellFocus",_initFocus:function(){var b=
this,a=b.grid;a.focus&&a.focus.registerArea({name:"header",priority:0,focusNode:b.innerNode,scope:b,doFocus:b._doFocus,doBlur:b._blurNode,onBlur:b._blurNode,connects:a.touch?[b.aspect(a,"onHeaderCellTouchStart",function(a){f.add(a.headerCellNode,b._focusClass)}),b.aspect(a,"onHeaderCellTouchEnd",function(a){f.remove(a.headerCellNode,b._focusClass)})]:[b.aspect(a,"onHeaderCellKeyDown","_onKeyDown"),b.connect(a,"onHeaderCellMouseDown",function(a){b._focusNode(b.getHeaderNode(a.columnId))})]})},_doFocus:function(b,
a){if(!this.hidden){var c=this._focusHeaderId&&this.getHeaderNode(this._focusHeaderId),c=this._focusNode(c||h(".gridxCell",this.domNode)[0]);this.grid.focus.stopEvent(c&&b);return c}return!1},_focusNode:function(b){if(b){var a=this,c=a.grid,e=a._focusHeaderId=b.getAttribute("colid");if(e)return a._blurNode(),c.body._focusCellCol=c._columnsById[e].index,f.add(b,a._focusClass),setTimeout(function(){g("webkit")&&f.add(b,a._focusClass);b.focus();8>g("ie")&&(a.innerNode.scrollLeft=a._scrollLeft);c.hScroller&&
c.hScroller.scrollToColumn(e,a.innerNode)},0),!0}return!1},_blurNode:function(){var b=h("."+this._focusClass,this.innerNode)[0];b&&f.remove(b,this._focusClass);return!0},_onKeyDown:function(b){var a=this.grid,c;c=a.isLeftToRight()?1:-1;var e=b.keyCode==l.LEFT_ARROW?-c:c;if(this._focusHeaderId&&!a._isCtrlKey(b)&&!b.altKey&&(b.keyCode==l.LEFT_ARROW||b.keyCode==l.RIGHT_ARROW))if(a.focus.stopEvent(b),c=a._columnsById[this._focusHeaderId],c=a._columns[c.index+e])this._focusNode(this.getHeaderNode(c.id)),
this.onMoveToHeaderCell(c.id,b)}})});
//# sourceMappingURL=Header.js.map