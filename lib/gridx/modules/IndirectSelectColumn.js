//>>built
define("gridx/modules/IndirectSelectColumn","dojo/_base/declare dojo/_base/array dojo/_base/event dojo/query dojo/_base/lang dojo/dom-class dojo/_base/Deferred dojo/keys ../core/_Module ./RowHeader".split(" "),function(p,m,q,k,r,g,n,s,t){return p(t,{name:"indirectSelect",required:["selectRow"],position:0,width:"23px",all:!0,preload:function(){var a=this,b=a.grid,c=b.select.row,d=a.arg("width"),d=a._col={id:"__indirectSelect__",decorator:r.hitch(this,"_createSelector"),headerStyle:"text-align: center;",
style:"text-align: center;",rowSelectable:!0,sortable:!1,filterable:!1,editable:!1,padding:!1,ignore:!0,declaredWidth:d,width:d};c.holdingCtrl=!0;a.batchConnect([b,"setColumns","_onSetColumns"],[c,"onHighlightChange","_onHighlightChange"],[c,"onSelectionChange","_onSelectionChange"],[c,"clear","_onClear"],[b.body,"onRender","_onSelectionChange"],b.filter&&[b.filter,"onFilter","_onSelectionChange"],[b.body,"onMoveToCell",function(c,d,f){c={columnId:"__indirectSelect__"};"__indirectSelect__"==b._columns[d].id?
a._onMouseOver(c):a._onMouseOut()}],[b,"onCellMouseOver","_onMouseOver"],[b,"onCellMouseOut","_onMouseOut"]);a._onSetColumns();c.selectByIndex&&a.arg("all")&&(a._allSelected={},d.name=a._createSelectAllBox(),a.connect(b,"onHeaderCellMouseDown",function(b){"__indirectSelect__"==b.columnId&&a._onSelectAll()}),a.connect(b,"onHeaderCellKeyDown",function(b){"__indirectSelect__"==b.columnId&&b.keyCode==s.SPACE&&(q.stop(b),a._onSelectAll())}));b.header._build()},_onSetColumns:function(){var a=this.grid,
b=a._columns,c=this._col;b.splice(this.arg("position"),0,c);a._columnsById[c.id]=c;m.forEach(b,function(a,b){a.index=b})},_updateSelectAll:function(){var a=this._createSelectAllBox();this.grid._columnsById.__indirectSelect__.name=a;this.grid.header.getHeaderNode("__indirectSelect__").innerHTML=a},_createSelectAllBox:function(){return this._createCheckBox(this._allSelected[this._getPageId()])},_getPageId:function(){return this.grid.view.rootStart+","+this.grid.view.rootCount},_createSelector:function(a,
b){var c=this.model.getMark(b),d=!this.grid.row(b,1).isSelectable();return this._createCheckBox(!0===c,"mixed"==c,d)},_createCheckBox:function(a,b,c){var d=this._getDijitClass();return['\x3cspan role\x3d"',this._isSingle()?"radio":"checkbox",'" class\x3d"gridxIndirectSelectionCheckBox dijitReset dijitInline ',d," ",a?d+"Checked":"",b?d+"Partial":"",c&&a?d+"CheckedDisabled":"",c&&b?d+"PartialDisabled":"",c&&!a&&!b?d+"Disabled":"",'" aria-checked\x3d"',a?"true":b?"mixed":"false",'"\x3e\x3cspan class\x3d"gridxIndirectSelectionCheckBoxInner"\x3e',
a?"\x26#10003;":b?"\x26#9646;":"\x26#9744;","\x3c/span\x3e\x3c/span\x3e"].join("")},_getDijitClass:function(){return this._isSingle()?"dijitRadio":"dijitCheckBox"},_isSingle:function(){var a=this.grid.select.row;return a.hasOwnProperty("multiple")&&!a.arg("multiple")},_onClear:function(a){var b=this._getDijitClass(),c=b+"Checked",b=b+"Partial",d=this.grid;k("."+c,d.bodyNode).removeClass(c);k("."+b,d.bodyNode).removeClass(b);d.select.row.isSelected(a)&&k('[rowid\x3d"'+d._escapeId(a)+'"].gridxRow .gridxIndirectSelectionCheckBox',
d.bodyNode).addClass(c);k("."+c,d.headerNode).removeClass(c).attr("aria-checked","false");this._allSelected={}},_onHighlightChange:function(a,b){var c=k('[visualindex\x3d"'+a.row+'"].gridxRow',this.grid.bodyNode)[0],d=c?k(".gridxIndirectSelectionCheckBox",c)[0]:void 0;if(d){var h=this._getDijitClass(),e="mixed"==b,f=b&&!e,c=c.getAttribute("rowid"),c=!this.grid.row(c).isSelectable();g.toggle(d,h+"Checked",f);g.toggle(d,h+"Partial",e);g.toggle(d,h+"CheckedDisabled",f&&c);g.toggle(d,h+"PartialDisabled",
e&&c);g.toggle(d,h+"Disabled",!f&&!e&&c);d.setAttribute("aria-checked",f?"true":e?"mixed":"false");d.firstChild.innerHTML=f?"\x26#10003;":e?"\x26#9646;":"\x26#9744;"}},_onMouseOver:function(a){var b=this.grid.select.row;b.arg("triggerOnCell")||"__indirectSelect__"==a.columnId?b.triggerOnCell||(this._triggerOnCell=!1,b.triggerOnCell=!0):this._onMouseOut()},_onMouseOut:function(){var a=this.grid.select.row;this.hasOwnProperty("_triggerOnCell")&&(a.triggerOnCell=!1,delete this._triggerOnCell)},_onSelectAll:function(){var a=
this.grid;a.select.row[this._allSelected[this._getPageId()]?"deselectByIndex":"selectByIndex"]([0,a.view.visualCount-1])},_onSelectionChange:function(){var a=this,b,c=a.grid,d,h=c.view,e=a.model,f=h.rootStart,l=h.rootCount;if(c.select.row.selectByIndex&&a.arg("all")){var k=m.filter(c.select.row.getSelected(),function(a){return!e.treePath(a).pop()}),h=c.select.row._getUnselectableRows(),g=m.filter(h,function(a){return!e.parentId(a)&&!c.select.row.isSelected(a)});l===e.size()?d=l&&l-g.length==k.length:
(b=new n,e.when({start:f,count:l},function(){var a=m.filter(m.map(k,function(a){return e.idToIndex(a)}),function(a){return a>=f&&a<f+l});g=m.filter(g,function(a){a=e.idToIndex(a);return a>=f&&a<f+l});d=l-g.length==a.length;b.callback()}));n.when(b,function(){a._allSelected[a._getPageId()]=d;a._updateSelectAll()})}}})});
//# sourceMappingURL=IndirectSelectColumn.js.map